<div class="container loading" ng-if="!sides">

    <div class="loading-msg">
        <h1>{{ 'loadingMsg' | translate }}</h1>
    </div>

</div>

<div class="container" ng-if="sides && sides.length > 1" ng-hide="sideIsSelected">

    <p>
        {{ 'marker.changeSide' | translate }}
    </p>

    <select ng-model="selectedSide" ng-change="currentScales(selectedSide)">
        <option></option>
        <option ng-repeat="side in sides" value="{{side.ID}}">{{side.Description}}</option>
    </select>
</div>

<div class="container loading" ng-if="!scales && scaleLoading">

    <div class="loading-msg">
        <h1>{{ 'loadingMsg' | translate }}</h1>
    </div>

</div>



<div class="container" ng-if="scales && !scaleLoading">

    <p>{{currentSide}}</p>

    <div class="scaleWrapper">

        <div class="scaleGroup" ng-repeat="group in groups">

            <div class="scaleContainer"
                 ng-repeat="scale in group"
                 ng-class="{'active': scale.ID == currentScaleID}"
                 ng-click="showScaleInfo(scale.ID); getLatestWorkRequest(scale.ID)">
                <label>{{scale.Description}}</label>
                <h3 ng-show="scale.weightCurrent">
                    {{scale.weightCurrent}} {{ 'marker.kg' | translate }}
                </h3>
                <h4 ng-show="scale.ID != currentScaleID && scale.rodsQuantity > 0">
                    {{scale.rodsQuantity}} {{ 'marker.pcs' | translate }}
                </h4>
                <h4 ng-show="scale.ID == currentScaleID && rodsQuantity > 0">
                    {{rodsQuantity}} {{ 'marker.pcs' | translate }}
                </h4>
            </div>
        </div>
    </div>

</div>

<div class="scaleDetailInfo" ng-show="currentScaleID">

    <div class="scaleInfo task">
        <h4 class="labelTask">{{ 'marker.task' | translate }}</h4>

        <div style="text-align: right">

        </div>

        <div class="controlsWrapper">
            <div class="controlsGroup">

                <div class="controlsRow">
                    <div class="captionTask">
                        {{ 'marker.profile' | translate }}
                    </div>
                    <div class="controlTask">
                        <select ng-model="selectedProfile"
                                ng-class="{'wrong': !selectedProfile}"
                                ng-change="getProfilePropertiesList();">
                            <option></option>
                            <option ng-selected="selectedProfile==profile.ID" ng-repeat="profile in profiles"
                                    value="{{profile.ID}}">
                                {{profile.Description}}
                            </option>
                        </select>
                    </div>
                </div>

                <div class="controlsRow">
                    <div class="captionTask">{{ 'marker.size' | translate }}</div>
                    <div class="controlTask">
                        <input type="text"
                               ng-model="length"
                               ng-change="calculate()" />
                    </div>
                </div>






            </div>

            <div class="controlsGroup" style="padding:0 0 0 10px;">

                <div>
                    <input type="checkbox"
                           ng-model="sandwichMode"
                           ng-change="enableControlOK();" />
                    {{ 'marker.sandwich' | translate }}
                </div>
                <div>
                    <input type="checkbox"
                           ng-model="approvingMode"
                           ng-change="enableControlOK()" />
                    {{ 'marker.byAccept' | translate }}
                </div>
                <div>
                    <input type="checkbox"
                           ng-model="nemera"
                           ng-change="enableControlOK()" />
                    {{ 'marker.nemera' | translate }}
                </div>
            </div>

        </div>

        <div class="controlsWrapper">
            <div class="controlsGroup">
                <div class="controlsRow">
                    <div class="captionTask">{{ 'marker.rodsQuantityPcs' | translate }}</div>
                    <div class="controlTask">
                        <input type="text"
                               ng-model="barQuantity"
                               ng-change="calculate()" />
                    </div>
                </div>
            </div>

            <div class="controlsGroup">
                <div class="controlsRow">
                    <div class="captionTask">
                        {{ 'marker.minMassRec' | translate }}
                    </div>
                    <div class="controlTask">
                        <input type="text"
                               readonly
                               ng-model="minMassRec" />
                    </div>

                </div>
            </div>
        </div>

        <div class="controlsWrapper">

            <div class="controlsGroup">
                <div class="controlsRow">
                    <div class="captionTask">
                        {{ 'marker.minMass' | translate }}
                    </div>
                    <div class="controlTask">
                        <input type="text"
                               ng-model="minMass"
                               ng-class="{'wrong': !minMass}"
                               my-number-check
                               ng-change="enableControlOK(); calculateMaxMass()" />
                    </div>
                </div>

                <div class="controlsRow">
                    <div class="captionTask">
                        {{ 'marker.sampleMass' | translate }}
                    </div>
                    <div class="controlTask">
                        <input type="text"
                               ng-model="sampleMass"
                               ng-change="calculate()" />
                    </div>
                </div>

                <div class="controlsRow">
                    <div class="captionTask">
                        {{ 'marker.sampleLength' | translate }}
                    </div>
                    <div class="controlTask">
                        <input type="text"
                               ng-model="sampleLength"
                               ng-change="calculate()" />
                    </div>
                </div>

            </div>
            <div class="controlsGroup">

                <div class="controlsRow">
                    <div class="captionTask">
                        {{ 'marker.maxMass' | translate }}
                    </div>
                    <div class="controlTask">
                        <input type="text"
                               ng-model="maxMass"
                               ng-class="{'wrong': !maxMass}"
                               my-number-check
                               ng-change="enableControlOK();" />
                    </div>
                </div>

                <div class="controlsRow">
                    <div class="captionTask">
                        {{ 'marker.rodsWeight' | translate }}
                    </div>
                    <div class="controlTask">
                        <input type="text" readonly ng-model="barWeight" />
                    </div>
                </div>

                <div class="controlsRow">
                    <div class="captionTask">
                        {{ 'marker.deviation' | translate }}
                    </div>
                    <div class="controlTask">
                        <input type="text" readonly
                               ng-model="deviation"
                               ng-class="{'wrong': deviationState == 'wrong'}" />
                    </div>
                </div>

            </div>
        </div>

        <div class="controls">
            <button class="btn"
                    ng-disabled="disableButtonOKTask"
                    ng-click="workRequest()">
                {{OKLabel}}
            </button>
        </div>
    </div>

    <div class="scaleInfo">

        <h4 class="scalesName">{{scalesDetailsInfo.ScalesName}}</h4>

        <span class="autoManuMsg" ng-show="scalesDetailsInfo && !scalesDetailsInfo.AUTO_MANU">
            {{ 'marker.autoMode' | translate }}
        </span>

        <p>
            <span ng-show="scalesDetailsInfo.POCKET_LOC">
                {{ 'marker.scalesBlocked' | translate }}
            </span>
            <span ng-show="sandwichMode && scalesDetailsInfo && !scalesDetailsInfo.PACK_SANDWICH">
                {{ 'marker.firstPack' | translate }}
            </span>
            <span ng-show="sandwichMode && scalesDetailsInfo.PACK_SANDWICH">
                {{ 'marker.secondPack' | translate }}
            </span>
        </p>

        <p>
            {{ 'marker.weight' | translate }}:
            <span class="scalesValue" ng-show="scalesDetailsInfo.WEIGHT_CURRENT">
                {{scalesDetailsInfo.WEIGHT_CURRENT}} {{ 'marker.kg' | translate }}
            </span>
        </p>

        <p>
            {{ 'marker.rodsQuantity' | translate }}:
            <span class="rodsValue" ng-show="rodsQuantity && rodsQuantity > 0">
                {{rodsQuantity}} {{ 'marker.pcs' | translate }}
            </span>
        </p>

        <p>
            {{ 'marker.rodsLeft' | translate }}:
            <span class="rodsValue" ng-show="rodsLeft">
                {{rodsLeft}} {{ 'marker.pcs' | translate }}
            </span>
        </p>

        <div class="isStableScalesIndicator" ng-show="scalesDetailsInfo.WEIGHT_STAB">
        </div>

        <span class="weightZeroIndicator" ng-show="scalesDetailsInfo.WEIGHT_ZERO">>0<</span>

        <div class="controls">

            <button class="btn"
                    ng-disabled="!(
                    (!sandwichModeAccepted && scalesDetailsInfo.AUTO_MANU && scalesDetailsInfo.WEIGHT_STAB)
                    ||
                    (sandwichModeAccepted && scalesDetailsInfo.PACK_SANDWICH && scalesDetailsInfo.AUTO_MANU && scalesDetailsInfo.WEIGHT_STAB))"
                    ng-click="doAction('ins_JobOrderOPCCommandTakeWeight','takeWeightLabel', 'marker.takeWeightButton')">
                {{takeWeightLabel}}
            </button>

            <button class="btn"
                    ng-show="sandwichModeAccepted"
                    ng-disabled="!((scalesDetailsInfo && !scalesDetailsInfo.PACK_SANDWICH) && scalesDetailsInfo.AUTO_MANU && scalesDetailsInfo.WEIGHT_STAB)"
                    ng-click="doAction('ins_JobOrderOPCCommandTakeTara','takeTaraLabel', 'marker.takeTaraButton')">
                {{takeTaraLabel}}
            </button>

            <button class="btn" ng-click="doAction('ins_MaterialLotByEquipment', 'testPrintLabel', 'marker.testPrintButton')">
                {{testPrintLabel}}
            </button>
        </div>

    </div>

    <div class="scaleInfo">

        <div class="section">

            <div class="sectionItem">
                <label>{{ 'marker.order' | translate }}:</label>
                <input type="text" class="input-small"
                       ng-change="checkIsAcceptedOrder()"
                       ng-model="commOrder"
                       my-enter="buildForm()" />
            </div>

            <div class="sectionItem">
                <label>{{ 'marker.brigadeNo' | translate }}:</label>
                <input type="text" class="input-small"
                       readonly
                       ng-model="brigadeNo" />
            </div>

            <div class="sectionItem">
                <label>{{ 'marker.date' | translate }}</label>
                <input type="text" class="input-small"
                       readonly
                       ng-model="prodDate" />
            </div>

        </div>

        <button class="btn specialLabelMode"
                ng-click="showBuildFormWindow('toggleModalMarker', 'reMarkerMode')"
                ng-class="{'active': reMarkerMode}">
            {{ 'marker.remarkingButton' | translate }}
        </button>

        <button class="btn specialLabelMode"
                ng-click="showBuildFormWindow('toggleModalSort', 'sortingMode')"
                ng-class="{'active': sortingMode}">
            {{ 'marker.sortingButton' | translate }}
        </button>

        <button class="btn specialLabelMode"
                ng-click="showBuildFormWindow('toggleModalDefect', 'defectMode')"
                ng-class="{'active': defectMode}">
            {{ 'marker.defectButton' | translate }}
        </button>

        <button class="btn specialLabelMode"
                ng-click="showBuildFormWindow('toggleModalSplit', 'splitMode')"
                ng-class="{'active': splitMode}">
            {{ 'marker.splitButton' | translate }}
        </button>

        <button class="btn specialLabelMode"
                ng-click="showBuildFormWindow('toggleModalHandMode', 'handMode')">
            Ручной ввод
        </button>

    </div>

</div>

<div class="black-wrapper" ng-show="isShowModal">
    <div class="modal">

        <!--<p>
            WorkDefinitionID: {{WorkDefinitionID}}
        </p>-->

        <div class="formWrapper">
            <form id="orderForm" novalidate></form>
        </div>

    </div>
</div>

<div class="black-wrapper" ng-show="toggleModalMarker">
    <div class="modal additional">
        <button ng-click="closeModal('toggleModalMarker');
                actionsOnExit('remarkerForm', 'isShowReMarkForm');"
                class="btn btn-circle pull-right">
            <i class="icon-remove"></i>
        </button>

        <h4>{{ 'marker.modalCaptions.reMarkingMode' | translate }}</h4>

        <div class="enterLabelWrapper">
            <label>{{ 'marker.modalCaptions.enterLabelNumber' | translate }}</label>
            <input type="text" class="labelNumber"
                   ng-model="labelNumber"
                   ng-readonly="readOnly" my-enter="buildFormSpecialMode('remarkerForm', 'isShowReMarkForm')" />
        </div>


        <div class="formWrapper" ng-show="isShowReMarkForm">
            <form id="remarkerForm" novalidate></form>
        </div>
    </div>
</div>

<div class="black-wrapper" ng-show="toggleModalSort">
    <div class="modal additional">
        <button ng-click="closeModal('toggleModalSort');
                actionsOnExit('sortingForm', 'isShowSortingForm');"
                class="btn btn-circle pull-right">
            <i class="icon-remove"></i>
        </button>

        <h4>{{ 'marker.modalCaptions.reSortingMode' | translate }}</h4>

        <div class="enterLabelWrapper">
            <label>{{ 'marker.modalCaptions.enterLabelNumber' | translate }}</label>
            <input type="text" class="labelNumber"
                   ng-model="labelNumber"
                   ng-readonly="readOnly" my-enter="buildFormSpecialMode('sortingForm', 'isShowSortingForm')" />
        </div>


        <div class="formWrapper" ng-show="isShowSortingForm">
            <form id="sortingForm" novalidate></form>
        </div>
    </div>
</div>

<div class="black-wrapper" ng-show="toggleModalDefect">
    <div class="modal additional">
        <button ng-click="closeModal('toggleModalDefect');
                actionsOnExit('defectForm', 'isShowDefectForm');"
                class="btn btn-circle pull-right">
            <i class="icon-remove"></i>
        </button>

        <h4>{{ 'marker.modalCaptions.DefectMode' | translate }}</h4>

        <div class="enterLabelWrapper">
            <label>{{ 'marker.modalCaptions.enterLabelNumber' | translate }}</label>
            <input type="text" class="labelNumber"
                   ng-model="labelNumber"
                   ng-readonly="readOnly" my-enter="buildFormSpecialMode('defectForm', 'isShowDefectForm')" />
        </div>


        <div class="formWrapper" ng-show="isShowDefectForm">
            <form id="defectForm" novalidate></form>
        </div>
    </div>
</div>

<div class="black-wrapper" ng-show="toggleModalSplit">
    <div class="modal additional">
        <button ng-click="closeModal('toggleModalSplit');
                actionsOnExit('splitForm', 'isShowSplitForm');"
                class="btn btn-circle pull-right">
            <i class="icon-remove"></i>
        </button>

        <h4>{{ 'marker.modalCaptions.SplitMode' | translate }}</h4>

        <div class="enterLabelWrapper">
            <label>{{ 'marker.modalCaptions.enterLabelNumber' | translate }}</label>
            <input type="text" class="labelNumber"
                   ng-model="labelNumber"
                   ng-readonly="readOnly" my-enter="buildFormSpecialMode('splitForm', 'isShowSplitForm')" />
        </div>

        <div class="enterLabelWrapper">
            <label>{{ 'marker.modalCaptions.changePackNumber' | translate }}</label>
            <select class="input-small">
                <option></option>
                <option>1</option>
                <option selected="selected">2</option>
                <option>3</option>
            </select>
        </div>


        <div class="formWrapper" ng-show="isShowSplitForm">
            <form id="splitForm" novalidate></form>
        </div>
    </div>
</div>

<div class="black-wrapper" ng-show="toggleModalHandMode">
    <div class="modal additional">
        <button ng-click="toggleModalHandMode = false"
                class="btn btn-circle pull-right">
            <i class="icon-remove"></i>
        </button>

        <h4>{{ 'marker.modalCaptions.HandMode' | translate }}</h4>

        <div class="enterLabelWrapper">
            <label>{{ 'marker.modalCaptions.enterName' | translate }}</label>
            <input type="text"
                   ng-model="handModeUserName"
                    />

            <label>{{ 'marker.modalCaptions.enterPassword' | translate }}</label>
            <input type="text"
                   ng-model="handModeUserPassword" />

            <button class="btn" ng-click="getHandModeCredentials()">
                {{ 'marker.modalCaptions.getHandModeCredentials' | translate }}
            </button>
        </div>

    </div>
</div>






