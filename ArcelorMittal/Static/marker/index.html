<div class="container loading" ng-if="!sides">

    <div class="loading-msg">
        <h1>{{ 'loadingMsg' | translate }}</h1>
    </div>

</div>

<div class="container" ng-if="sides && sides.length > 1" ng-hide="sideIsSelected">

    <p>
        Выберите сторону стана для работы:
    </p>

    <select ng-model="selectedSide" ng-change="currentScales(selectedSide)">
        <option></option>
        <option ng-repeat="side in sides" value="{{side.ID}}">{{side.Description}}</option>
    </select>
</div>

<div class="container loading" ng-if="!scales && scaleLoading">

    <div class="loading-msg">
        <h1>{{ 'loadingMsg' | translate }}</h1>
    </div>

</div>

<div class="container" ng-if="scales && !scaleLoading">

    <div class="scaleWrapper">

        <div class="scaleGroup" ng-repeat="group in groups">

            <div class="scaleContainer"
                 ng-repeat="scale in group"
                 ng-class="{'active': scale.ID == currentScaleID}"
                 ng-click="showScaleInfo(scale.ID); getLatestWorkRequests(scale.ID)">
                <label>{{scale.Description}}</label>
                <h3>{{scale.data.WEIGHT_CURRENT}} кг</h3>
                <h4 ng-if="scale.data.RodsQuanity">{{scale.data.RodsQuanity}} шт</h4>
            </div>
        </div>
    </div>

</div>

<div class="scaleDetailInfo" ng-show="currentScaleID">

    <div class="scaleInfo task">
        <label>Задание</label>

        <div style="text-align: right">

        </div>

        <div class="controlsWrapper">
            <div class="controlsGroup">
                <table>
                    <tr>
                        <td>Профиль</td>
                        <td>
                            <select ng-model="selectedProfile"
                                    ng-change="getProfilePropertiesList()">
                                <option></option>
                                <option ng-selected="selectedProfile==profile.ID" ng-repeat="profile in profiles"
                                        value="{{profile.ID}}">
                                    {{profile.Description}}
                                </option>
                            </select>
                        </td>
                    </tr>

                    <tr>
                        <td>Размер(м.)</td>
                        <td>
                            <input type="text"
                                   ng-model="length"
                                   ng-change="calculate()" />
                        </td>
                    </tr>

                    <tr>
                        <td>Количество прутков(шт.)</td>
                        <td>
                            <input type="text"
                                   ng-model="barQuantity"
                                   ng-change="calculate()" />
                        </td>
                    </tr>
                </table>
            </div>

            <div class="controlsGroup" style="padding:10px;">

                <div>
                    <input type="checkbox" ng-model="sandwichMode" />
                    Бутерброд
                </div>
                <div>
                    <input type="checkbox" ng-model="approvingMode" />
                    По подтверждению
                </div>
            </div>
            
        </div>

        <div class="controlsWrapper">

            <div class="controlsGroup">
                <table>
                    <tr>
                        <td>Масса максимум(кг.)</td>
                        <td>
                            <input type="text"
                                   ng-model="maxMass" 
                                   ng-class="{'wrong': !maxMass}"
                                   ng-change="enableControlOK()" />
                        </td>
                    </tr>

                    <tr>
                        <td>Масса образца(кг.)</td>
                        <td>
                            <input type="text"
                                   ng-model="sampleMass"
                                   ng-change="calculate()" />
                        </td>
                    </tr>

                    <tr>
                        <td>Длина образца(м.)</td>
                        <td>
                            <input type="text"
                                   ng-model="sampleLength"
                                   ng-change="calculate()" />
                        </td>
                    </tr>
                </table>
            </div>
            <div class="controlsGroup">
                <table>
                    <tr>
                        <td>Масса минимум(кг.)</td>
                        <td>
                            <input type="text"
                                   ng-model="minMass"
                                   ng-class="{'wrong': !minMass}" 
                                   ng-change="enableControlOK()" />
                        </td>
                    </tr>

                    <tr>
                        <td>Вес прутка(кг.)</td>
                        <td><input type="text" readonly ng-model="barWeight" /></td>
                    </tr>

                    <tr>
                        <td>Отклонение(%)</td>
                        <td>
                            <input type="text" readonly
                                   ng-model="deviation"
                                   ng-class="{'wrong': deviationState == 'wrong'}" />
                        </td>
                    </tr>
                </table>
            </div>
        </div>

        <div class="controls">
            <button class="btn"
                    ng-disabled="disableButtonOKTask"
                    ng-click="workRequest()">{{OKLabel}}</button>
        </div>
    </div>

    <div class="scaleInfo">
        <h4 class="scalesName">{{scalesDetailsInfo.ScalesName}}</h4>

        <p>
            Вес:
            <span class="scalesValue" ng-show="scalesDetailsInfo.WEIGHT_CURRENT">
                {{scalesDetailsInfo.WEIGHT_CURRENT}} кг
            </span>
        </p>

        <p>
            Количество прутков:
            <span class="rodsValue" ng-show="scalesDetailsInfo.RodsQuanity || rodsQuantity">
                {{scalesDetailsInfo.RodsQuanity || rodsQuantity }} шт
            </span>
        </p>

        <p>
            Осталось прутков:
            <span class="rodsValue" ng-show="scalesDetailsInfo.RodsLeft || rodsLeft">
                {{scalesDetailsInfo.RodsLeft || rodsLeft}} шт
            </span>
        </p>

        <div class="isStableScalesIndicator" ng-show="scalesDetailsInfo.WEIGHT_STAB">
        </div>

        <span class="weightZeroIndicator" ng-show="scalesDetailsInfo.WEIGHT_ZERO">>0<</span>

        <div class="controls">
            
            <button class="btn" 
                    ng-disabled="!scalesDetailsInfo.AUTO_MANU || !scalesDetailsInfo.WEIGHT_STAB" 
                    ng-click="doAction('ins_JobOrderOPCCommandTakeWeightByCommOrder')">
                Взять вес
            </button>

            <button class="btn"
                    ng-show="sandwichMode"
                    ng-disabled="!scalesDetailsInfo.AUTO_MANU || !scalesDetailsInfo.WEIGHT_STAB"
                     ng-click="doAction('ins_JobOrderOPCCommandTakeTaraByCommOrder')">
                Взять тару
            </button>

            <button class="btn" ng-click="doAction('ins_MaterialLotByCommOrder')">
                Тестовая печать
            </button>
        </div>

    </div>

    <div class="scaleInfo">

        <div class="section">

            <div class="sectionItem">
                <label>Заказ:</label>
                <input type="text" class="input-small"
                       ng-model="orderNumber"
                       my-enter="buildForm(orderNumber)" />  
            </div>

            <div class="sectionItem">
                <label>№ бригады:</label>
                <input type="text" class="input-small"
                       readonly
                       ng-model="brigadeNo" />  
            </div>

            <div class="sectionItem">
                <label>Дата</label>
                <input type="text" class="input-small"
                       readonly
                       ng-model="prodDate" />  
            </div>
                     
        </div>

        

    </div>

</div>



<div class="black-wrapper" ng-show="isShowModal">
    <div class="modal">

        <div class="formWrapper">
            <form id="orderForm" novalidate></form>
        </div>

    </div>
</div>




